$(document).ready(function(){function t(t){if(t.files&&t.files[0]){var s=new FileReader;s.onload=function(t){o.src=t.target.result;var s=o.width,d=o.height;e.setWidth(Math.min(window.innerWidth,s)),e.setHeight(d),$("body").css("width",Math.max(window.innerWidth,s)),$("body").css("height",d),n.setX(e.getWidth()/2-n.getTextWidth()/2),a.setX(e.getWidth()/2-a.getTextWidth()/2),a.setY(e.getHeight()-60),i.draw()},s.readAsDataURL(t.files[0])}}var e=new Kinetic.Stage({container:"container",width:300,height:300}),i=new Kinetic.Layer,n=new Kinetic.Text({x:e.getWidth()/2,y:0,text:"",fontSize:"60",fontFamily:"Impact",fill:"white",stroke:"black",strokeWidth:2,draggable:!0});i.add(n),$(".top-txt").keyup(function(){n.setText($(this).val()),i.draw()});var a=new Kinetic.Text({x:e.getWidth()/2,y:e.getHeight()-60,text:"",fontSize:"60",fontFamily:"Impact",fill:"white",stroke:"black",strokeWidth:2,draggable:!0});i.add(a),$(".bottom-txt").keyup(function(){a.setText($(this).val()),i.draw()});var o=new Image;o.src="",o.onload=function(){var t=new Kinetic.Image({x:0,y:0,width:0,height:0,image:o});i.add(t),t.moveToBottom(),i.draw()};var s=new Kinetic.Text({x:0,y:0,text:"made with JSMeme",fontSize:"25",fontFamily:"cssfont",fill:"white",stroke:"black",strokeWidth:2,opacity:.5});s.hide(),i.add(s),e.add(i),i.draw(),$("[data-toggle='tooltip']").tooltip(),window.onresize=function(){e.setWidth(window.innerWidth/100*80)};$("#dropper").change(function(){t(this),$("#uploadModal").modal("hide")}),$("#top-spinner").on("change",function(){$(this).val()<101&&$(this).val()>-1?n.fontSize($(this).val()):alert("The font size is too small or large. Please fix it."),i.draw()}),$("#bottom-spinner").on("change",function(){$(this).val()<101&&$(this).val()>-1?a.fontSize($(this).val()):alert("The font size is too small or large. Please fix it."),i.draw()}),$("#top-thickness-spinner").on("change",function(){n.setStrokeWidth($(this).val()),i.draw()}),$("#bottom-thickness-spinner").on("change",function(){a.setStrokeWidth($(this).val()),i.draw()}),$("#save-btn").click(function(){s.hide(),i.draw(),$(".kineticjs-content canvas").css("width",e.getWidth()).css("height",e.getHeight()),document.querySelector(".kineticjs-content canvas").toBlob(function(t){saveAs(t,"generated meme.png")})});var d=!1;$("body").on("contextmenu",function(t){t.preventDefault(),$("#cc-menu").show().addClass("animated bounceIn"),$("#cc-menu").css({top:event.pageY+"px",left:event.pageX+"px"}),d=!0}),$("body").mousedown(function(t){switch(t.which){case 1:$("#cc-menu").removeClass("animated bounceIn").addClass("animated bounceOut"),setTimeout(function(){$("#cc-menu").removeClass("animated bounceOut").hide(),d=!1},800)}})});
